
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>制作一个可同时支持BIOS和UEFI安全启动的系统 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-asciidoc-admonition-icons/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-add-js-css/d564bc26b98807bc8b8760ad8e43db47-style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-all-navigator/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="debug.html" />
    
    
    <link rel="prev" href="uefi-make.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../elf/">
            
                <a href="../elf/">
            
                    
                    elf
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../elf/elf-1.html">
            
                <a href="../elf/elf-1.html">
            
                    
                    ELF文件的静态结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../elf/elf-2.html">
            
                <a href="../elf/elf-2.html">
            
                    
                    ELF文件的装载与动态连接
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../elf/elf-3.html">
            
                <a href="../elf/elf-3.html">
            
                    
                    示例程序
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../hardware/">
            
                <a href="../hardware/">
            
                    
                    硬件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../hardware/address/">
            
                <a href="../hardware/address/">
            
                    
                    x86_64内存寻址
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../hardware/address/summary.html">
            
                <a href="../hardware/address/summary.html">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../hardware/address/real_address.html">
            
                <a href="../hardware/address/real_address.html">
            
                    
                    实地址寻址
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../hardware/address/segmented_address.html">
            
                <a href="../hardware/address/segmented_address.html">
            
                    
                    分段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../hardware/address/page_address.html">
            
                <a href="../hardware/address/page_address.html">
            
                    
                    分页
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../hardware/address/example.html">
            
                <a href="../hardware/address/example.html">
            
                    
                    一个完整的例子
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../hardware/disk/">
            
                <a href="../hardware/disk/">
            
                    
                    计算机启动
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../hardware/disk/summary.html">
            
                <a href="../hardware/disk/summary.html">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../hardware/disk/disk-chs-lba.html">
            
                <a href="../hardware/disk/disk-chs-lba.html">
            
                    
                    CHS/LBA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../hardware/disk/disk-bios.html">
            
                <a href="../hardware/disk/disk-bios.html">
            
                    
                    BIOS/MBR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../hardware/disk/uefi.html">
            
                <a href="../hardware/disk/uefi.html">
            
                    
                    UEFI/GPT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="../hardware/disk/uefi-example.html">
            
                <a href="../hardware/disk/uefi-example.html">
            
                    
                    一个UEFI例子
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="../hardware/disk/end.html">
            
                <a href="../hardware/disk/end.html">
            
                    
                    总结
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../hardware/inst/">
            
                <a href="../hardware/inst/">
            
                    
                    x86/64指令编码内幕
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../hardware/inst/inst-1.html">
            
                <a href="../hardware/inst/inst-1.html">
            
                    
                    序言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../hardware/inst/inst-2.html">
            
                <a href="../hardware/inst/inst-2.html">
            
                    
                    指令格式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../hardware/inst/inst-3.html">
            
                <a href="../hardware/inst/inst-3.html">
            
                    
                    深入了解prefix
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../hardware/inst/inst-4.html">
            
                <a href="../hardware/inst/inst-4.html">
            
                    
                    REX prefix
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="../hardware/inst/inst-5.html">
            
                <a href="../hardware/inst/inst-5.html">
            
                    
                    指令opcod码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.6" data-path="../hardware/inst/inst-6.html">
            
                <a href="../hardware/inst/inst-6.html">
            
                    
                    ModRM寻址模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.7" data-path="../hardware/inst/inst-7.html">
            
                <a href="../hardware/inst/inst-7.html">
            
                    
                    SIB补充寻址
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.8" data-path="../hardware/inst/inst-8.html">
            
                <a href="../hardware/inst/inst-8.html">
            
                    
                    displacement值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.9" data-path="../hardware/inst/inst-9.html">
            
                <a href="../hardware/inst/inst-9.html">
            
                    
                    immediate值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.10" data-path="../hardware/inst/inst-10.html">
            
                <a href="../hardware/inst/inst-10.html">
            
                    
                    指令的解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.11" data-path="../hardware/inst/inst-addon-1.html">
            
                <a href="../hardware/inst/inst-addon-1.html">
            
                    
                    ModRM 与 SIB 设计上的 2 个原则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.12" data-path="../hardware/inst/inst-addon-2.html">
            
                <a href="../hardware/inst/inst-addon-2.html">
            
                    
                    default（缺省） 与 effective（有效）
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.13" data-path="../hardware/inst/inst-addon-3.html">
            
                <a href="../hardware/inst/inst-addon-3.html">
            
                    
                    指令的 operand size
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.14" data-path="../hardware/inst/inst-addon-4.html">
            
                <a href="../hardware/inst/inst-addon-4.html">
            
                    
                    解开指令长度的迷惑
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="./">
            
                <a href="./">
            
                    
                    引导器GRUB2
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="summary.html">
            
                <a href="summary.html">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="bios-make.html">
            
                <a href="bios-make.html">
            
                    
                    制作一个使用BIOS的系统
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="uefi-make.html">
            
                <a href="uefi-make.html">
            
                    
                    制作一个使用UEFI的系统
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.4" data-path="secure-uefi-bios.html">
            
                <a href="secure-uefi-bios.html">
            
                    
                    制作一个可同时支持BIOS和UEFI安全启动的系统
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="debug.html">
            
                <a href="debug.html">
            
                    
                    如何调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="grub-mod.html">
            
                <a href="grub-mod.html">
            
                    
                    如何编写一个Grub2的模块
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="bios-detail.html">
            
                <a href="bios-detail.html">
            
                    
                    BIOS版本实现
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="uefi-detail.html">
            
                <a href="uefi-detail.html">
            
                    
                    UEFI版本实现
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="memory.adoc">
            
                <span>
            
                    
                    内存分配
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../other/">
            
                <a href="../other/">
            
                    
                    杂项
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../other/gdb/kernel-debug-qemu.html">
            
                <a href="../other/gdb/kernel-debug-qemu.html">
            
                    
                    使用qemu/gdb进行内核调试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >制作一个可同时支持BIOS和UEFI安全启动的系统</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div class="paragraph">
<p>&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5B66;&#x4F1A;&#x5236;&#x4F5C;BIOS&#x542F;&#x52A8;&#x7684;&#x78C1;&#x76D8;&#x955C;&#x50CF;&#x548C;UEFI&#x542F;&#x52A8;&#x7684;&#x78C1;&#x76D8;&#x955C;&#x50CF;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x5728;&#x4F7F;&#x7528;ubuntu&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x77E5;&#x9053;&#x5927;&#x5BB6;&#x6709;&#x6CA1;&#x6709;&#x6CE8;&#x610F;&#x8FC7;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x73B0;&#x8C61;&#xFF0C;&#x5728;&#x652F;&#x6301;UEFI&#x542F;&#x52A8;&#x7684;&#x865A;&#x62DF;&#x673A;&#x4E2D;&#x4F7F;&#x7528;efibootmgr&#x547D;&#x4EE4;&#x67E5;&#x770B;ubuntu&#x7CFB;&#x7EDF;&#x7684;&#x542F;&#x52A8;&#x987A;&#x5E8F;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>efibootmgr -v
BootCurrent: 0005
Timeout: 0 seconds
BootOrder: 0005,0000,0001,0002,0003,0004
Boot0000* UiApp FvVol(7cb8bdc9-f8eb-4f34-aaea-3ee4af6516a1)/FvFile(462caa21-7614-4503-836e-8ab6f4662331)
Boot0001* UEFI VBOX CD-ROM VB0-01f003f6         PciRoot(0x0)/Pci(0x1,0x1)/Ata(0,0,0)N.....YM....R,Y.
Boot0002* UEFI VBOX CD-ROM VB2-01700376         PciRoot(0x0)/Pci(0x1,0x1)/Ata(1,0,0)N.....YM....R,Y.
Boot0003* UEFI VBOX HARDDISK VBf5cb0757-31383519        PciRoot(0x0)/Pci(0xd,0x0)/Sata(0,65535,0)N.....YM....R,Y.
Boot0004* EFI Internal Shell    FvVol(7cb8bdc9-f8eb-4f34-aaea-3ee4af6516a1)/FvFile(7c04a583-9e3e-4f1c-ad65-e05268d0b4d1)
Boot0005* ubuntu        HD(1,GPT,6dee24a7-4fe0-466f-b6f8-546e2048aceb,0x800,0x100000)/File(\EFI\ubuntu\shimx64.efi)</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x6211;&#x4EEC;&#x77E5;&#x9053;efi&#x4F1A;&#x4ECE; <em>Boot0005</em> &#x8FDB;&#x884C;&#x542F;&#x52A8;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x4E3A; <em>\EFI\ubuntu\shimx64.efi</em>&#x3002;&#x90A3;&#x4E48; <em>\EFI\ubuntu\shimx64.efi</em> &#x662F;&#x4F55;&#x7269;&#xFF1F;&#x5982;&#x679C;&#x60F3;&#x77E5;&#x9053;shimx64.efi&#x6587;&#x4EF6;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x540E;&#x7EED;&#x6587;&#x7AE0;&#x3002;&#x8FD9;&#x4E2A;&#x7AE0;&#x8282;&#x6211;&#x4EEC;&#x4E0D;&#x4F1A;&#x4ECB;&#x7ECD;&#x8FD9;&#x4E2A;&#x5185;&#x5BB9;&#xFF0C;&#x7559;&#x5728;&#x540E;&#x7EED;&#x7AE0;&#x8282;&#x4ECB;&#x7ECD;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x7AE0;&#x8282;&#x6211;&#x4EEC;&#x5C06;&#x5B66;&#x4E60;&#x5982;&#x4F55;&#x4F7F;&#x7528;shim&#x5236;&#x4F5C;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x652F;&#x6301;BIOS&#x542F;&#x52A8;&#xFF0C;&#x4E5F;&#x652F;&#x6301;UEFI&#x65B9;&#x5F0F;&#x542F;&#x52A8;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x652F;&#x6301;&#x5B89;&#x5168;&#x542F;&#x52A8;&#x7684;&#x78C1;&#x76D8;&#x955C;&#x50CF;&#x3002;</p>
</div>
<div class="paragraph">
<p>&#x8FD9;&#x91CC;&#x4E0D;&#x4F1A;&#x4ECB;&#x7ECD;grub&#x7684;&#x7F16;&#x8BD1;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x300A;Grub2&#x90A3;&#x4E9B;&#x4E8B; - &#x5236;&#x4F5C;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;UEFI&#x7684;&#x7CFB;&#x7EDF;&#x300B;&#x4E2D;&#x7F16;&#x8BD1;&#x8BF4;&#x4EA7;&#x751F;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5047;&#x8BBE;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x4E3A;bios-uefi</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ WORKSPACE=/opt/workspace/
$ mkdir -p bios-uefi
$ cd $WORKSPACE/bios-uefi</code></pre>
</div>
</div>
<div class="sect1">
<h2 id="__">&#x5236;&#x4F5C;&#x79D8;&#x94A5;&#x6587;&#x4EF6;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5C06;&#x521B;&#x5EFA;OVMF&#x5B89;&#x5168;&#x542F;&#x52A8;&#x6240;&#x4F7F;&#x7528;&#x7684;DB&#xFF0C;KEY&#xFF0C;PK&#x79D8;&#x94A5;&#x3002;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x811A;&#x672C;&#x521B;&#x5EFA;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>#!/bin/bash
# Copyright (c) 2015 by Roderick W. Smith
# Licensed under the terms of the GPL v3

echo -n &quot;Enter a Common Name to embed in the keys: &quot;
read NAME

for n in PK KEK db
do
  openssl genrsa -out &quot;$n.key&quot; 2048
  openssl req -new -x509 -sha256 -subj &quot;/CN=$NAME/&quot; -key &quot;$n.key&quot; -out &quot;$n.pem&quot; -days 7300
  openssl x509 -in &quot;$n.pem&quot; -inform PEM -out &quot;$n.der&quot; -outform DER
done


GUID=`python3 -c &apos;import uuid; print(str(uuid.uuid1()))&apos;`
echo $GUID &gt; myGUID.txt

for n in PK KEK db
do
  sbsiglist --owner &quot;$GUID&quot; --type x509 --output &quot;$n.esl&quot; &quot;$n.der&quot;
done

for n in PK=PK KEK=PK db=KEK
do
  sbvarsign --key &quot;${n#*=}.key&quot; --cert &quot;${n#*=}.pem&quot;  --output &quot;${n%=*}.auth&quot; &quot;${n%=*}&quot; &quot;${n%=*}.esl&quot;
done

chmod 0600 *.key

echo &quot;&quot;
echo &quot;&quot;
echo &quot;For use with KeyTool, copy the *.auth and *.esl files to a FAT USB&quot;
echo &quot;flash drive or to your EFI System Partition (ESP).&quot;
echo &quot;For use with most UEFIs&apos; built-in key managers, copy the *.cer files;&quot;
echo &quot;but some UEFIs require the *.auth files.&quot;
echo &quot;&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x5C06;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x547D;&#x540D;&#x4E3A;mykeys.sh&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ chmod +x mykeys.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x7136;&#x540E;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ mkdir -p keys
$ cd keys
$ ./mykeys.sh
Enter a Common Name to embed in the keys: Foo, Inc. Secure Boot key set
Generating RSA private key, 2048 bit long modulus (2 primes)
..................+++++
.......................................................................................+++++
e is 65537 (0x010001)
Generating RSA private key, 2048 bit long modulus (2 primes)
........+++++
.......................+++++
e is 65537 (0x010001)
Generating RSA private key, 2048 bit long modulus (2 primes)
.....................................................................................................+++++
......................+++++
e is 65537 (0x010001)


For use with KeyTool, copy the *.auth and *.esl files to a FAT USB
flash drive or to your EFI System Partition (ESP).
For use with most UEFIs&apos; built-in key managers, copy the *.cer files;
but some UEFIs require the *.auth files.</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x8FD9;&#x4E9B;&#x79D8;&#x94A5;&#x4E3B;&#x8981;&#x4E3A;OVMF&#x6240;&#x4F7F;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;shim&#x4F7F;&#x7528;&#x7684;&#x79D8;&#x94A5;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>openssl genrsa -out &quot;shim.key&quot; 2048
openssl req -new -x509 -sha256 -subj &quot;/CN=shim/&quot; -key &quot;shim.key&quot; -out &quot;shim.pem&quot; -days 7300
openssl x509 -in &quot;shim.pem&quot; -inform PEM -out &quot;shim.der&quot; -outform DER</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x83B7;&#x5F97;&#x4E86;PK&#xFF0C;DB&#xFF0C;KEK&#x548C;SHIM&#x79D8;&#x94A5;&#x3002;&#x8FD9;&#x4E9B;&#x79D8;&#x94A5;&#x662F;&#x540E;&#x7EED;&#x5B89;&#x5168;&#x542F;&#x52A8;&#x6240;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#x7684;&#x3002;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shim">SHIM&#x7F16;&#x8BD1;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#x8FD9;&#x4E2A;&#x7AE0;&#x8282;&#x4ECB;&#x7ECD;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7EC4;&#x4EF6;&#x7F16;&#x8BD1;&#x5373;SHIM</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cd $WORKSPACE
$ git clone https://github.com/rhboot/shim.git
$ make update
$ sudo make EFI_PATH=/usr/lib VENDOR_CERT_FILE=$WORKSPACE/bios-uefi/keys/shim.der ENABLE_SBSIGN=1 ENABLE_SHIM_CERT=1  install-as-data
...
Signing Unsigned original image
install -d -m 0755 //usr/share//shim/15.4/x64/
install -m 0644 shimx64.efi //usr/share//shim/15.4/x64//
install -m 0644 BOOTX64.CSV //usr/share//shim/15.4/x64//
install -m 0644 mmx64.efi.signed //usr/share//shim/15.4/x64//mmx64.efi
install -m 0644 fbx64.efi.signed //usr/share//shim/15.4/x64//fbx64.efi</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x83B7;&#x5F97;&#x4E86;&#x5DF2;&#x7ECF;&#x7B7E;&#x53D1;&#x597D;&#x7684;shimx64.efi&#xFF0C;mmx64.efi&#x548C;fbx64.efi&#xFF0C;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x5728;//usr/share//shim/15.4/x64//&#x76EE;&#x5F55;&#x4E2D;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="___2">&#x521B;&#x5EFA;&#x78C1;&#x76D8;&#x955C;&#x50CF;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#x8FD9;&#x91CC;&#x4E3A;&#x4E86;&#x65B9;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x521B;&#x5EFA;&#x76F8;&#x5173;&#x7684;&#x78C1;&#x76D8;&#x955C;&#x50CF;&#x548C;&#x5206;&#x533A;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ truncate --size 20G bios-uefi.img

# &#x521B;&#x5EFA;&#x78C1;&#x76D8;&#x5206;&#x533A;
$ sgdisk --clear \
  --new 1::+1M --typecode=1:ef02 --change-name=1:&apos;BIOS boot partition&apos; \
  --new 2::+100M --typecode=2:ef00 --change-name=2:&apos;EFI System&apos; \
  --new 3::-0 --typecode=3:8300 --change-name=3:&apos;Linux root filesystem&apos; \
  bios-uefi.img
Creating new GPT entries in memory.
Setting name!
partNum is 0
Setting name!
partNum is 1
Setting name!
partNum is 2
Warning: The kernel is still using the old partition table.
The new table will be used at the next reboot or after you
run partprobe(8) or kpartx(8)
The operation has completed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x4F7F;&#x7528;sgdisk&#x547D;&#x4EE4;&#x521B;&#x5EFA;&#x4E86;3&#x4E2A;&#x5206;&#x533A;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x91CD;&#x70B9;&#x5173;&#x6CE8;&#x7684;&#x662F;&#x5404;&#x79CD;typecode&#xFF0C;&#x6BCF;&#x4E00;&#x79CD;typecode&#x8868;&#x793A;&#x4E0D;&#x540C;&#x7684;&#x5206;&#x533A;&#x7C7B;&#x578B;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x5206;&#x533A;&#x7528;&#x4E8E;BIOS</p>
</li>
<li>
<p>&#x7B2C;&#x4E8C;&#x4E2A;&#x5206;&#x533A;&#x7528;&#x4E8E;EFI&#x7CFB;&#x7EDF;&#x5206;&#x533A;</p>
</li>
<li>
<p>&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x4F5C;&#x4E3A;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#x4F7F;&#x7528;gdisk&#x67E5;&#x770B;&#x5206;&#x533A;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ gdisk -l bios-uefi.img
GPT fdisk (gdisk) version 1.0.5

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present

Found valid GPT with protective MBR; using GPT.
Disk bios-uefi.img: 41943040 sectors, 20.0 GiB
Sector size (logical): 512 bytes
Disk identifier (GUID): 812C7F89-1AFC-4E66-9923-73378996DF32
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 41943006
Partitions will be aligned on 2048-sector boundaries
Total free space is 2014 sectors (1007.0 KiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048            4095   1024.0 KiB  EF02  BIOS boot partition
   2            4096          208895   100.0 MiB   EF00  EFI System
   3          208896        41943006   19.9 GiB    8300  Linux root filesystem</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x505A;&#x597D;&#x5206;&#x533A;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x76F8;&#x5173;&#x7684;&#x5206;&#x533A;&#x8FDB;&#x884C;&#x683C;&#x5F0F;&#x5316;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># &#x4F7F;&#x7528;&#x56DE;&#x73AF;&#x8BBE;&#x5907;
$ LOOPDEV=$(losetup --find --show bios-uefi.img)
$ sudo partprobe ${LOOPDEV}

# &#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;
$ sudo mkfs.fat -F32 ${LOOPDEV}p2
$ sudo mkfs.ext4 -F -L &quot;root&quot; ${LOOPDEV}p3 # &#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;root&#x4F5C;&#x4E3A;&#x6807;&#x7B7E;
mke2fs 1.45.5 (07-Jan-2020)
Discarding device blocks: done
Creating filesystem with 5216763 4k blocks and 1305600 inodes
Filesystem UUID: 197e687e-b9b1-4d5b-8ff2-87e635d08801
Superblock backups stored on blocks:
        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208,
        4096000

Allocating group tables: done
Writing inode tables: done
Creating journal (32768 blocks): done
Writing superblocks and filesystem accounting information: done</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x4F7F;&#x7528;&#x4EE5;&#x4E0A;&#x6B65;&#x9AA4;&#xFF0C;&#x683C;&#x5F0F;&#x5316;EFI&#x7CFB;&#x7EDF;&#x5206;&#x533A;&#x548C;root&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x5206;&#x533A;&#x3002;</p>
</div>
<div class="paragraph">
<p>&#x9996;&#x5148;&#x5C06;rootfs.tar&#x89E3;&#x538B;&#x5230;&#x7CFB;&#x7EDF;&#x7684;&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x4E2D;&#xFF0C;&#x5C06;&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x4F5C;&#x4E3A;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ MOUNTDIR=$(mktemp -d -t workXXXXXX)
$ mount ${LOOPDEV}p3 $MOUNTDIR
$ sudo tar -C $MOUNTDIR -xf $WORKSPACE/buildroot/output/images/rootfs.tar</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__bios">&#x5B89;&#x88C5;&#x652F;&#x6301;BIOS&#x542F;&#x52A8;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x5C06;grub&#x5B89;&#x88C5;&#x5230;&#x78C1;&#x76D8;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x6247;&#x533A;&#xFF0C;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x5728;GPT&#x7CFB;&#x7EDF;&#x5206;&#x533A;&#x7684;&#x78C1;&#x76D8;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x6247;&#x533A;&#x53EB;&#x505A;PMBR&#x3002;&#x7531;&#x4E8E;&#x5176;&#x524D;446&#x4E2A;&#x5B57;&#x8282;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x5C06;GRUB&#x5B89;&#x88C5;&#x5230;&#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ sudo /opt/workspace/grub-bios/sbin/grub-install --boot-directory=/mnt/boot --modules=&quot;part_msdos&quot; ${LOOPDEV}</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x5B89;&#x88C5;&#x597D;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x505A;&#x4E00;&#x4E0B;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ sudo umount $MOUNTDIR</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x83B7;&#x5F97;&#x4E00;&#x4E2A;&#x652F;&#x6301;bios&#x542F;&#x52A8;&#x7684;&#x7CFB;&#x7EDF;&#x76D8;&#xFF0C;&#x7531;&#x4E8E;&#x8FD8;&#x6CA1;&#x6709;&#x628A;&#x5185;&#x6838;&#x955C;&#x50CF;&#x653E;&#x8FDB;&#x53BB;&#xFF0C;&#x6240;&#x4EE5;&#x8FD8;&#x4E0D;&#x80FD;&#x6B63;&#x5E38;&#x542F;&#x52A8;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ qemu-system-x86_64 -m 512 -drive file=./bios-uefi.img,format=raw -m 512</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x7CFB;&#x7EDF;&#x5C06;&#x6B63;&#x5E38;&#x542F;&#x52A8;&#x3002;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__uefi">&#x5B89;&#x88C5;&#x652F;&#x6301;&#x5B89;&#x5168;&#x542F;&#x52A8;&#x7684;UEFI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x5C06;&#x5B89;&#x88C5;&#x652F;&#x6301;UEFI&#x5B89;&#x5168;&#x542F;&#x52A8;&#x7684;&#x7CFB;&#x7EDF;&#x76D8;&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x65E0;&#x8BBA;&#x6253;&#x5F00;&#x5B89;&#x5168;&#x542F;&#x52A8;&#x6216;&#x8005;&#x6CA1;&#x6709;&#x6253;&#x5F00;&#x7CFB;&#x7EDF;&#x90FD;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x542F;&#x52A8;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#x6211;&#x4EEC;&#x7684;&#x5DE5;&#x4F5C;&#x5427;&#x3002;</p>
</div>
<div class="paragraph">
<p>&#x521B;&#x5EFA;EFI&#x7684;&#x57FA;&#x672C;&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;shim&#x76F8;&#x5173;&#x7684;&#x6587;&#x4EF6;&#x62F7;&#x8D1D;&#x5230;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E2D;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ MOUNTDIR=$(mktemp -d -t workXXXXXX)
# &#x52A0;&#x8F7D;&#x7CFB;&#x7EDF;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;EFI&#x7CFB;&#x7EDF;&#x5206;&#x533A;
$ mount ${LOOPDEV}p2 $MOUNTDIR
$ mkdir -p EFI/BOOT
$ mkdir -p EFI/test
$ cp //usr/share//shim/15.4/x64//* .</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x7136;&#x540E;&#xFF0C;&#x4F7F;&#x7528;shim&#x79D8;&#x94A5;&#x5BF9;shimx64.efi&#x7A0B;&#x5E8F;&#x8FDB;&#x884C;&#x7B7E;&#x53D1;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ sbsign --key keys/db.key --cert keys/db.pem --output shimx64.efi.signed shimx64.efi
warning: data remaining[804864 vs 930262]: gaps between PE/COFF sections?
warning: data remaining[804864 vs 930264]: gaps between PE/COFF sections?
Signing Unsigned original image</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x7B7E;&#x53D1;grub&#x955C;&#x50CF;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BD4;&#x8F83;&#x65B0;&#x7684;Grub&#x7248;&#x672C;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;sbat&#x6587;&#x4EF6;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cat &lt;&lt;SBATCFG &gt; sbat.csv
sbat,1,SBAT Version,sbat,1,https://github.com/rhboot/shim/blob/main/SBAT.md
shim,1,UEFI shim,shim,1,https://github.com/rhboot/shim
SBATCFG
$ $WORKSPACE/grub-efi/bin/grub-mkimage \
  -d /usr/lib/grub/x86_64-efi \
  -o ./grubx64.efi \
  -p /EFI/test \
  --sbat sbat.csv \
  -O x86_64-efi \
    fat iso9660 part_gpt part_msdos normal boot linux configfile loopback chain efifwsetup efi_gop \
    efi_uga ls search search_label search_fs_uuid search_fs_file gfxterm gfxterm_background \
    gfxterm_menu test all_video loadenv exfat ext2 ntfs btrfs hfsplus udf
$ sbsign --key keys/shim.key --cert keys/shim.pem --output grubx64.efi.signed grubx64.efi
Signing Unsigned original image</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x4E86;grub-mkimage&#x547D;&#x4EE4;&#x521B;&#x5EFA;grubx64.efi&#x7A0B;&#x5E8F;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x51E0;&#x4E2A;&#x9009;&#x9879;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>-O &#x6307;&#x793A;&#x76EE;&#x6807;&#x67B6;&#x6784;</p>
</li>
<li>
<p>-p &#x544A;&#x8BC9;&#x521B;&#x5EFA;&#x76EE;&#x5F55;&#x7684;&#x524D;&#x7F00;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x53EB;&#x505A;test&#x7684;&#x6D4B;&#x8BD5;&#x7CFB;&#x7EDF;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#x4E3A;/EFI/test&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x5176;&#x4ED6;&#x76EE;&#x5F55;</p>
</li>
<li>
<p>--sbat sbat&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x4E0B;&#x4E00;&#x4E2A;&#x7AE0;&#x8282;&#x6211;&#x4EEC;&#x5C06;&#x8BE6;&#x7EC6;&#x7684;&#x4ECB;&#x7ECD;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#x6B64;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;DB&#x79D8;&#x94A5;&#x7B7E;&#x53D1;&#x4E86;SHIM&#xFF0C;&#x4F7F;&#x7528;shim&#x79D8;&#x94A5;&#x7B7E;&#x53D1;&#x4E86;grub&#x3002;&#x5728;Ubuntu&#x53D1;&#x884C;&#x7248;&#x672C;&#x4E2D;&#x4E00;&#x822C;&#x901A;&#x8FC7;&#x5FAE;&#x8F6F;&#x8FDB;&#x884C;&#x7B7E;&#x53D1;SHIM&#xFF0C;&#x4F7F;&#x7528;Canonical&#x7B7E;&#x53D1;&#x5176;&#x4ED6;&#x6587;&#x4EF6;&#x3002;</p>
</div>
<div class="paragraph">
<p>&#x63A5;&#x7740;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5236;&#x4F5C;&#x4E00;&#x4E2A;&#x652F;&#x6301;&#x5B89;&#x5168;&#x542F;&#x52A8;&#x7684;OVMF&#x56FA;&#x4EF6;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;&#x5728;&#x300A;Grub2&#x90A3;&#x4E9B;&#x4E8B; - &#x5236;&#x4F5C;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;UEFI&#x7684;&#x7CFB;&#x7EDF;&#x300B;&#x5236;&#x4F5C;&#x7684;OVMF&#x7A0B;&#x5E8F;&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cp $WORKSPACE/tianocore/edk2/Build/OvmfX64/DEBUG_GCC5/FV/OVMF_CODE.fd \
     $WORKSPACE/tianocore/edk2/Build/OvmfX64/DEBUG_GCC5/FV/OVMF_VARS.fd \
     $WORKSPACE/tianocore/edk2/Build/OvmfX64/DEBUG_GCC5/FV/OVMF.fd ..
$ cp keys/db.der keys/KEK.der keys/PK.der hda-contents/</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x5C06;OVMF&#x76F8;&#x5173;&#x7F16;&#x8BD1;&#x7684;&#x6587;&#x4EF6;&#x62F7;&#x8D1D;&#x5230;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;DB&#xFF0C;KER&#xFF0C;PK&#x7684;&#x8BC1;&#x4E66;&#x6587;&#x4EF6;&#x653E;&#x5230;hda-contents&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x6211;&#x4EEC;&#x7528;&#x4E8E;&#x5C06;&#x8BC1;&#x4E66;&#x5BFC;&#x5165;&#x5230;OVMF&#x4E2D;&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ qemu-system-x86_64 -L . \
  -drive if=pflash,format=raw,readonly,file=OVMF_CODE.fd \
  -drive if=pflash,format=raw,file=OVMF_VARS.fd \
  -drive file=fat:rw:hda-contents,media=disk,format=raw \
  -net none</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x542F;&#x52A8;qemu&#x540E;&#xFF0C;&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x5C06;&#x76F8;&#x5173;&#x7684;&#x8BC1;&#x4E66;&#x5BFC;&#x5165;&#x5230;OVMF&#x56FA;&#x4EF6;&#x4E2D;&#x3002;&#x5728;UEFI&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x6982;&#x5FF5;&#x5373;&#x53D8;&#x91CF;&#xFF0C;UEFI&#x6839;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x95EA;&#x5B58;&#x4E2D;&#x7684;&#x53D8;&#x91CF;&#x6765;&#x51B3;&#x5B9A;&#x6267;&#x884C;&#x3002;&#x6240;&#x4EE5;&#x64CD;&#x4F5C;UEFI&#x7684;&#x53D8;&#x91CF;&#x5176;&#x5B9E;&#x662F;&#x76F4;&#x63A5;&#x64CD;&#x4F5C;&#x95EA;&#x5B58;&#x4E2D;&#x7684;&#x5B58;&#x50A8;&#x4FE1;&#x606F;&#x3002;&#x6211;&#x4EEC;&#x8FD0;&#x884C;&#x652F;&#x6301;UEFI&#x7684;qemu&#x6A21;&#x62DF;&#x5668;&#x540E;&#x3002;&#x5C06;&#x8FDB;&#x5165;&#x4E00;&#x4E0B;&#x754C;&#x9762;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/9.jpg" alt="ovmf&#x542F;&#x52A8;&#x754C;&#x9762;"></span></p>
</div>
<div class="paragraph">
<p>&#x7B49;&#x5F85;&#x51E0;&#x79D2;&#x949F;&#xFF0C;&#x6216;&#x8005;&#x76F4;&#x63A5;&#x6309;&#x5176;&#x4ED6;&#x4EFB;&#x4F55;&#x6309;&#x952E;&#xFF0C;&#x7CFB;&#x7EDF;&#x5C06;&#x8FDB;&#x5165; <em>UEFI Shell</em>&#x3002;&#x8FDB;&#x5165;&#x547D;&#x4EE4;&#x884C;&#x754C;&#x9762;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x8F93;&#x5165; <em>exit</em> &#x3002;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8FDB;&#x5165;UEFI&#x7684;&#x56FE;&#x5F62;&#x914D;&#x7F6E;&#x754C;&#x9762;&#x3002;&#x4F9D;&#x6B21;&#x8FDB;&#x5165; <em>&quot;Device Manager&quot;&#x2192;&quot;Secure Boot Configuration&quot;&#x2192; &quot;Secure Boot Mode&quot;</em> &#xFF0C;&#x9009;&#x62E9; <em>Custom Mode</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/10.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x9009;&#x62E9;&#x51FA;&#x73B0;&#x7684;&#x201C;Custome Secure Boot Options&#x201D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8FDB;&#x5165;&#x76F8;&#x5173;&#x79D8;&#x94A5;&#x5BFC;&#x5165;&#x7684;&#x754C;&#x9762;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/11.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x4E0B;&#x9762;&#x5C06;&#x4EE5;PK&#x79D8;&#x94A5;&#x7684;&#x5BFC;&#x5165;&#x4E3A;&#x4F8B;&#xFF0C;&#x8BF4;&#x660E;&#x5982;&#x4F55;&#x5F53;&#x5982;PK&#x79D8;&#x94A5;&#x5BFC;&#x5165;UEFI&#x4E2D;&#x3002;&#x9009;&#x62E9; &#x201C;PK Options&#x201D;&#xFF0C;&#x8FDB;&#x5165;PK&#x7684;&#x5BFC;&#x5165;&#x754C;&#x9762;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/12.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x9009;&#x62E9;&#x201C;Enroll PK&#x201D;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/13.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x9009;&#x62E9;&#x201C;Enroll PK Using File&#x201D;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/14.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x9009;&#x62E9;&#x5BF9;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x91CC;&#x9009;&#x62E9;&#x201C;PK.der&#x201D;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/15.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x6700;&#x540E;&#x5C06;&#x6587;&#x4EF6;&#x63D0;&#x4EA4;&#x5230;UEFI&#x56FA;&#x4EF6;&#x4E2D;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/16.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x7136;&#x540E;&#x5206;&#x522B;&#x5BFC;&#x5165;DB&#xFF0C;PKE&#x79D8;&#x94A5;&#xFF0C;&#x9000;&#x51FA;&#x5230;&quot;Secure Boot Configuration&quot;&#x754C;&#x9762;&#x4E2D;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x754C;&#x9762;&#x4E2D;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x660E;&#x786E;&#x7684;&#x770B;&#x5230;&#x5B89;&#x5168;&#x542F;&#x52A8;&#x9879;&#x5DF2;&#x7ECF;&#x88AB;&#x6253;&#x5F00;&#x4E86;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/17.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x7EE7;&#x7EED;&#x9000;&#x51FA;&#x5230;&#x4E3B;&#x754C;&#x9762;&#xFF0C;&#x9009;&#x62E9;&#x201C;Continue&#x201D;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/18.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x6700;&#x540E;&#x6267;&#x884C;Enter&#x952E;&#x91CD;&#x542F;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x652F;&#x6301;&#x5B89;&#x5168;&#x542F;&#x52A8;&#x7684;UEFI&#x56FA;&#x4EF6;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/19.jpg" alt="Custom Mode"></span></p>
</div>
<div class="paragraph">
<p>&#x7EC6;&#x5FC3;&#x4E00;&#x70B9;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;OVMF_CODE.fd&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x6CA1;&#x6709;&#x53D8;&#x5316;&#xFF0C;&#x53D8;&#x5316;&#x7684;&#x662F;OVMF_VARS.fd&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#x4E86;UEFI&#x4E2D;&#x7684;&#x53D8;&#x91CF;&#x9879;&#x3002;&#x5728;&#x771F;&#x5B9E;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x4E2D;&#xFF0C;&#x5F88;&#x591A;&#x786C;&#x4EF6;&#x5546;&#x5B58;&#x653E;&#x7684;&#x662F;&#x5FAE;&#x8F6F;&#x7684;DB&#xFF0C;KEK&#x8BC1;&#x4E66;&#xFF0C;&#x4EE5;&#x53CA;&#x81EA;&#x5DF1;&#x7684;PK&#x8BC1;&#x4E66;&#x3002;&#x800C;&#x5728;OVMF&#x4E2D;&#x9ED8;&#x8BA4;&#x6CA1;&#x6709;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E86;&#x81EA;&#x5DF1;&#x7684;PK&#xFF0C;DB&#xFF0C;KEK&#x79D8;&#x94A5;&#x3002;</p>
</div>
<div class="paragraph">
<p>&#x56DE;&#x5F52;&#x6B63;&#x4F20;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x5728;&#x7F16;&#x8BD1;shim&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x8BA9;&#x5176;&#x81EA;&#x52A8;&#x7B7E;&#x53D1;&#x4E86;mmx64&#x548C;fbx64&#x6240;&#x4EE5;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x7B7E;&#x53D1;&#x4E86;&#xFF0C;&#x4F46;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x662F;shim&#x7684;mok&#x79D8;&#x94A5;&#x7BA1;&#x7406;&#x5668;&#x4E2D;&#x5176;&#x5B9E;&#x5B58;&#x653E;&#x7684;&#x662F;&#x4E24;&#x4E2A;&#x8BC1;&#x4E66;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x5176;&#x81EA;&#x52A8;&#x751F;&#x6210;&#x7684;&#x7528;&#x4E8E;&#x7B7E;&#x53D1;mmx64&#x548C;fbx64&#x7684;&#x8BC1;&#x4E66;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x662F;&#x6211;&#x4EEC;&#x5BFC;&#x5165;&#x7684;shim&#x8BC1;&#x4E66;&#x3002;</p>
</div>
<div class="paragraph">
<p>&#x5C06; shimx64.efi.signed&#xFF0C;grubx64.efi.signed&#xFF0C;mmx64.efi&#xFF0C;fbx64.efi&#x653E;&#x5230;&#x6B63;&#x786E;&#x7684;&#x4F4D;&#x7F6E;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ install -m 0644 shimx64.efi.signed EFI/test/shimx64.efi
$ install -m 0644 shimx64.efi.signed EFI/BOOT/BOOTX64.efi
$ install -m 0644 grubx64.efi.signed EFI/test/grubx64.efi
$ install -m 0644 mmx64.efi EFI/test/mmx64.efi
$ install -m 0644 mmx64.efi EFI/BOOT/mmx64.efi
$ install -m 0644 fbx64.efi EFI/BOOT/fbx64.efi</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x6839;&#x636E;UEFI&#x7684;&#x914D;&#x7F6E;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;BOOTX64.CSV&#x6587;&#x4EF6;&#xFF0C;UEFI&#x4F1A;&#x9ED8;&#x8BA4;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x627E;&#x5230;&#x6B63;&#x786E;&#x7684;&#x542F;&#x52A8;&#x9009;&#x9879;&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ echo &quot;shimx64.efi,test,,This is the boot entry for Test&quot; | iconv -t UCS-2LE &gt;BOOTX64.CSV
$ install -m 0644 BOOTX64.CSV EFI/test/BOOTX64.CSV</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x548C;&#x5B89;&#x5168;&#x542F;&#x52A8;&#x76F8;&#x5173;&#x7684;&#x914D;&#x7F6E;&#x57FA;&#x672C;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#xFF0C;&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x8FD8;&#x9700;&#x8981;&#x914D;&#x7F6E;grub&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ sudo blkid ${LOOPDEV}p3
/dev/loop1p3: LABEL=&quot;root&quot; UUID=&quot;197e687e-b9b1-4d5b-8ff2-87e635d08801&quot; TYPE=&quot;ext4&quot; PARTLABEL=&quot;Linux root filesystem&quot; PARTUUID=&quot;7e844aef-eb31-433c-9ae0-7330e17f601b&quot;
cat &lt;&lt;GRUBCFG &gt; grub.cfg
search.fs_uuid 197e687e-b9b1-4d5b-8ff2-87e635d08801 root hd0,gpt3
set prefix=(\$root)&apos;/boot/grub&apos;
configfile \$prefix/grub.cfg
GRUBCFG
$ cp grub.cfg EFI/test/</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x8BFB;&#x8FC7;&#x4E4B;&#x524D;&#x6587;&#x7AE0;&#x7684;&#x5BF9;&#x8FD9;&#x6BB5;&#x4F30;&#x8BA1;&#x8FD9;&#x6837;&#x964C;&#x751F;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;blkid&#x627E;&#x5230;&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x7684;UUID&#xFF0C;&#x4F5C;&#x4E3A;grub&#x7684;&#x9ED8;&#x8BA4;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x8BA9;grub&#x4ECE;&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x627E;&#x771F;&#x5B9E;&#x7684;grub&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6865;&#x63A5;&#x7684;&#x8FC7;&#x7A0B;&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ MOUNTDIR=$(mktemp -d -t workXXXXXX)
$ sudo mount /dev/loop1p3 $MOUNTDIR

$ cp $linux_kernl/arch/x86_64/boot/bzImage .
sbsign --key keys/shim.key --cert keys/shim.pem --output bzImage.signed bzImage
$ cp bzImage.signed $MOUNTDIR/boot/bzImage</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x4F7F;&#x7528;&#x4EE5;&#x4E0A;&#x547D;&#x4EE4;&#x7B7E;&#x53D1;&#x4E86;linux&#x5185;&#x6838;&#x955C;&#x50CF;&#xFF0C;&#x5728;UEFI&#x5B89;&#x5168;&#x542F;&#x52A8;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;SHIM&#x673A;&#x5236;&#xFF0C;&#x9700;&#x8981;&#x5C06;grub&#x548C;&#x5185;&#x6838;&#xFF0C;&#x4EE5;&#x53CA;&#x5185;&#x6838;&#x6A21;&#x5757;&#x90FD;&#x8981;&#x7ECF;&#x8FC7;shim&#x79D8;&#x94A5;&#x7684;&#x7B7E;&#x53D1;&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;shim&#x79D8;&#x94A5;&#x7B7E;&#x53D1;&#x5185;&#x6838;&#x955C;&#x50CF;&#xFF0C;&#x5E76;&#x5C06;&#x5185;&#x6838;&#x955C;&#x50CF;&#x62F7;&#x8D1D;&#x5230;&#x4E86;&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x7684;/boot&#x76EE;&#x5F55;&#x4E2D;&#x3002;&#x540C;&#x65F6;&#x8FD8;&#x9700;&#x8981;&#x66F4;&#x6539;&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x7684;grub.cfg&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F4D;&#x4E8E; <em>/boot/grub/grub.cfg</em> &#x4E2D;&#x3002;&#x5C06;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x4E3A;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>set default=&quot;0&quot;
set timeout=&quot;5&quot;

menuentry &quot;Buildroot&quot; {
        set root=&apos;hd0,gpt3&apos;
        linux /boot/bzImage root=/dev/sda3 rootwait console=tty1
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x8FD9;&#x4E2A;&#x78C1;&#x76D8;&#x955C;&#x50CF;&#x4F7F;&#x7528;&#x4E86;3&#x4E2A;&#x5206;&#x533A;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;bios&#xFF0C;&#x5176;&#x5B9E;&#x6CA1;&#x7528;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x7528;&#x4E8E;uefi&#x7CFB;&#x7EDF;&#x5206;&#x533A;&#xFF0C;&#x7B2C;&#x4E09;&#x4E2A;&#x7528;&#x4E8E;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x8BBE;&#x7F6E;&#x4E86;&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x4F5C;&#x4E3A;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;</p>
</div>
<div class="paragraph">
<p>&#x5C06;&#x7B2C;&#x4E09;&#x4E2A;&#x5206;&#x533A;&#x5378;&#x8F7D;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ sudo umount $MOUNTDIR</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x63A5;&#x7740;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x7B2C;&#x4E8C;&#x4E2A;&#x5206;&#x533A;&#x6302;&#x5728;&#x5230;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x5236;&#x4F5C;&#x7684;EFI&#x6587;&#x4EF6;&#x62F7;&#x8D1D;&#x5230;&#x8FD9;&#x4E2A;&#x5206;&#x533A;&#x4E2D;&#x3002;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo mount ${LOOPDEV}p2 $MOUNTDIR
sudo cp -R EFI $MOUNTDIR</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5B8C;&#x6210;&#x4E86;UEFI&#x5B89;&#x5168;&#x7CFB;&#x7EDF;&#x7684;&#x78C1;&#x76D8;&#x955C;&#x50CF;&#x3002;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="___3">&#x9A8C;&#x8BC1;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#xFF0C;&#x652F;&#x6301;UEFI&#x5B89;&#x5168;&#x542F;&#x52A8;&#x7684;uefi&#x78C1;&#x76D8;&#x80FD;&#x591F;&#x542F;&#x52A8;&#x6210;&#x529F;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ sudo qemu-system-x86_64    \
 -drive if=pflash,format=raw,readonly,file=./OVMF_CODE.fd   \
   -drive if=pflash,format=raw,file=./OVMF_VARS.fd \
   -drive file=./bios-uefi.img,format=raw -m 512 \
   -net none -serial file:serial.log</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x9A8C;&#x8BC1;&#x5173;&#x95ED;UEFI&#x5B89;&#x5168;&#x542F;&#x52A8;&#x7684;&#x8FD9;&#x4E2A;&#x78C1;&#x76D8;&#x80FD;&#x5426;&#x542F;&#x52A8;&#x6210;&#x529F;&#xFF0C;OVMF.fd&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x76F4;&#x63A5;&#x4ECE;&#x7F16;&#x8BD1;&#x7684;&#x7ED3;&#x679C;&#x83B7;&#x53D6;&#xFF0C;&#x6CA1;&#x6709;&#x6253;&#x5F00;&#x5B89;&#x5168;&#x542F;&#x52A8;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ sudo qemu-system-x86_64    \
 -bios OVMF.fd \
   -drive file=./bios-uefi.img,format=raw -m 512 \
   -net none -serial file:serial.log</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x9A8C;&#x8BC1;bios&#x65B9;&#x5F0F;&#x7684;&#x8FD9;&#x4E2A;&#x78C1;&#x76D8;&#x80FD;&#x5426;&#x542F;&#x52A8;&#x6210;&#x529F;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ sudo qemu-system-x86_64   \
   -drive file=./bios-uefi.img,format=raw -m 512</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4EE5;&#x4E0A;3&#x4E09;&#x79CD;&#x60C5;&#x51B5;&#x90FD;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x542F;&#x52A8;&#x3002;</p>
</div>
</div>
</div>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="uefi-make.html" class="navigation navigation-prev " aria-label="Previous page: 制作一个使用UEFI的系统">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="debug.html" class="navigation navigation-next " aria-label="Next page: 如何调试">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"制作一个可同时支持BIOS和UEFI安全启动的系统","publish":false,"level":"1.4.4","depth":2,"next":{"title":"如何调试","level":"1.4.5","depth":2,"path":"grub/debug.adoc","ref":"grub/debug.adoc","articles":[]},"previous":{"title":"制作一个使用UEFI的系统","level":"1.4.3","depth":2,"path":"grub/uefi-make.adoc","ref":"grub/uefi-make.adoc","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["asciidoc-admonition-icons","asciidoc-include","code","collapsible-menu","add-js-css","all-navigator","livereload"],"pluginsConfig":{"disqus":{"shortName":"znipps"},"asciidoc-include":{"syntax":"gitbook"},"collapsible-menu":{},"livereload":{},"atoc":{"addClass":true,"className":"atoc"},"asciidoc-admonition-icons":{},"search":{},"page-toc":{"selector":".markdown-section h2","position":"top","showByDefault":true},"all-navigator":{"showNumber":true,"showTitle":true},"add-js-css":{"js":["./style/style.js"],"css":["./style/style.css"]},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"devops":{"livere_token":"MTAyMC8zMjk4MC85NTQy"},"livere":{"uid":"MTAyMC81MzQ5Ni8yOTk3MA=="},"admonitions":{"note":{"classes":"fa icon-note","title":"提示","content":""},"tip":{"classes":"fa icon-tip","title":"小贴士","content":""},"important":{"classes":"fa icon-important","title":"重要","content":""},"caution":{"classes":"fa icon-caution","title":"注意","content":""},"warning":{"classes":"fa icon-warning","title":"警告","content":""}}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"grub/secure-uefi-bios.adoc","mtime":"2021-05-21T01:31:42.085Z","type":"asciidoc"},"gitbook":{"version":"3.2.3","time":"2021-05-28T09:45:19.968Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-add-js-css/bb4b3e0e16f0bfdb86d817bf7bebcc4a-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-all-navigator/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-all-navigator/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

